#read in the data
library("qtl")
library("vqtl")
setwd("/Users/mbyrd/StapletonLab/Thomas/Stapleton-Lab/vQTL IBM and Manching")
geno<-read.csv("/Data/IBM94markerset08seq.csv")
geno<-read.csv("Data/IBM94markerset08seq.csv")
randp<- read.csv("Data/RandIBM642006PyearData.csv")
famp<- read.csv("Data/Pyear2006fielddata.csv")
#tidying data with bad genotypes (MO062, MO075, and MO066)
bad = NULL
#tidying data with bad genotypes (MO062, MO075, and MO066)
bad = NULL
for (w in 1:length(randp$Line)){
if (as.character(randp$Line[w]) == "MO075" | as.character(randp$Line[w]) == "MO062"| as.character(randp$Line[w]) == "MO066"){
bad = c(bad,w)
}
}
randp = randp[-bad,]
#start forming a cross object
dat = data.frame(randp$height.in.,randp$NumTasselBranches,randp$TasselBranchAngle.deg.,randp$Line)
for(x in 1:3235){
dat = cbind(dat,"0")
}
colnames(dat) <- NULL
dat <- data.frame(lapply(dat, as.character), stringsAsFactors=FALSE)
#stiching genotypes to phenotypes
for (x in 1:dim(dat)[1]){
a <- as.character(dat[x,4])
if (0 == length(which(colnames(geno) == a))){
next
}
vect = as.character((geno[,which(colnames(geno) == a)]))
for (q in 1:3235){
dat[x,q+4] = vect[q]
}
}
beep()
#looking for columns that did not populate
empty = which(dat[,10] == "0")
nonpop = NULL
for (x in 1:length(empty)){
nonpop = c(nonpop,dat[empty[x],2])
}
nonpop
#all these columns are either B73 or have not Line as such, we discard them
randp = randp[-empty,]
#now we have a solid cross object
inc = as.numeric(geno$incre_new)
colnames(dat) = c("Height","Number of Branches","Branch Angle","Line",names)
#we want to add the increment values
dat = dat[,-4]
vect = c(rep("",3),inc)
dat = rbind(vect,dat)
write.csv(dat, file = "Github/Stapleton-Lab/vQTL IBM and Manching/cross.csv")
write.csv(dat, file = "cross.csv")
#then delete the first column
#####With the cross#####
cross = read.cross(file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "/" file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "/Users/mbyrd/StapletonLab/Thomas/Stapleton-Lab/vQTL IBM and Manching" file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "/Users/mbyrd/StapletonLab/Thomas/Stapleton-Lab/vQTL IBM and Manching/", file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "/Users/mbyrd/StapletonLab/Thomas/Stapleton-Lab/vQTL IBM and Manching/", file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "/Users/mbyrd/StapletonLab/Thomas/Stapleton-Lab/vQTL IBM and Manching/", file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "/Users/mbyrd/StapletonLab/Thomas/Stapleton-Lab/vQTL IBM and Manching/", file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "Users/mbyrd/StapletonLab/Thomas/Stapleton-Lab/vQTL IBM and Manching/", file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(file = "cross.csv")cross <- drop.nullmarkers(cross)
write.csv(dat, file = "cross.csv")
#then delete the first column
#####With the cross#####
cross = read.cross(file = "cross.csv")cross <- drop.nullmarkers(cross)
install.packages("beepr")
#read in the data
library("qtl")
library("vqtl")
setwd("/Users/mbyrd/StapletonLab/Thomas/Stapleton-Lab/vQTL IBM and Manching")
geno<-read.csv("Data/IBM94markerset08seq.csv")
randp<- read.csv("Data/RandIBM642006PyearData.csv")
famp<- read.csv("Data/Pyear2006fielddata.csv")
#tidying data with bad genotypes (MO062, MO075, and MO066)
bad = NULL
for (w in 1:length(randp$Line)){
if (as.character(randp$Line[w]) == "MO075" | as.character(randp$Line[w]) == "MO062"| as.character(randp$Line[w]) == "MO066"){
bad = c(bad,w)
}
}
randp = randp[-bad,]
#start forming a cross object
dat = data.frame(randp$height.in.,randp$NumTasselBranches,randp$TasselBranchAngle.deg.,randp$Line)
for(x in 1:3235){
dat = cbind(dat,"0")
}
colnames(dat) <- NULL
dat <- data.frame(lapply(dat, as.character), stringsAsFactors=FALSE)
#stiching genotypes to phenotypes
for (x in 1:dim(dat)[1]){
a <- as.character(dat[x,4])
if (0 == length(which(colnames(geno) == a))){
next
}
vect = as.character((geno[,which(colnames(geno) == a)]))
for (q in 1:3235){
dat[x,q+4] = vect[q]
}
}
beep()
beep()
install.packages("beepr")
beep()
beepr::beep()
beep()
#looking for columns that did not populate
empty = which(dat[,10] == "0")
nonpop = NULL
for (x in 1:length(empty)){
nonpop = c(nonpop,dat[empty[x],2])
}
nonpop
#all these columns are either B73 or have not Line as such, we discard them
randp = randp[-empty,]
#now we have a solid cross object
inc = as.numeric(geno$incre_new)
colnames(dat) = c("Height","Number of Branches","Branch Angle","Line",names)
#we want to add the increment values
dat = dat[,-4]
vect = c(rep("",3),inc)
dat = rbind(vect,dat)
write.csv(dat, file = "cross.csv")
#we want to add the increment values
dat = dat[,-4]
#then delete the first column
#####With the cross#####
cross = read.cross(file = "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "~StapletonLab/Thomas/Stapleton-Lab/vQTL IBM and Manching/", file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "StapletonLab/Thomas/Stapleton-Lab/vQTL IBM and Manching/", file= "cross.csv")cross <- drop.nullmarkers(cross)
write.csv(dat, file = "Data/cross.csv")
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "Data/", file= "cross.csv")cross <- drop.nullmarkers(cross)
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "Data/", file= "cross.csv")
#then delete the first column
#####With the cross#####
cross = read.cross(file= "cross.csv")
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "Data/", file= "cross.csv")
#then delete the first column
#####With the cross#####
cross = read.cross(dir = "test/", file= "cross_test.csv")
cross <- drop.nullmarkers(cross)
#scan with variance
cross <- calc.genoprob(cross)
outv <- scanonevar(cross = cross,
mean.formula = Height ~ mean.QTL.add,
var.formula = ~ var.QTL.add)
